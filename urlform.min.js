"use strict";var E={id:"",prefix:"",shareURLBtn:"#shareURLBtn",shareURL:"#shareURL",shareURLArea:"#shareURLArea",queryLocation:"fragment",preserveExtra:!1,callback:null,cleanURL:!1},l,m,y,h,d=!1;function J(e,r){m=e,l={},l=I(r),y=document.querySelector(l.shareURLBtn),y!=null&&y.addEventListener("click",()=>P()),h=document.getElementById(l.id),h===null&&console.warn("URLFormJS: Could not find the form for the given 'id' in 'FormOptions'."),d=!0}function A(){if(!d)throw new Error("URLFormJS: Init() must be called first to initialize the URLFormJS module.");let e=g();w(e.pairs),P(e)}function w(e){if(!d)throw new Error("URLFormJS: Init() must be called first to initialize the URLFormJS module.");b(e)}function g(){let e={query:window.location.search,queryPairs:k(),fragment:p(),fragmentParts:v(),fragmentPairs:q()};return e.pairs={...e.queryPairs,...e.fragmentPairs},e}function k(){var e=new URL(window.location.href);let r={};for(var t of e.searchParams.entries())r[t[0]]=t[1];return r}function q(){let e=v().query;var r={};return n(e)||e.split("&").forEach(t=>{let a=t.split("=");if(a[1]===void 0){r[a[0]]=null;return}r[a[0]]=decodeURI(a[1])}),r}function p(){var e=window.location.hash.split("#");return navigator.userAgent.includes("Firefox")||(e=performance.getEntriesByType("navigation")[0].name.split("#")),e.length<2?"":e[1]}function v(){let e={before:"",query:"",after:""},r=p().split("?");if(r.length>1)e.before=r[0],e.query=r[1];else return e.before=r[0],e;if(!n(e.query)){let t=e.query.split(":~:");t.length>1&&(e.query=t[0],e.after=t[1])}return e}function b(e){try{for(let r of m){let t=r.name,a=e[t],f=r.id;if(n(f)&&(f=l.prefix+t),n(r.func)||r.func(),r.type=="bool"&&r.funcTrue!==void 0&&a!==void 0&&a!==""&&(a==="true"||a===!0)&&r.funcTrue(),!n(a)){if(r.type=="bool"&&(a=="true"||a===!0)){let u=document.getElementById(f);u!=null&&(u.checked=!0);continue}let i=document.getElementById(f);i!=null&&(i.value=a)}}}finally{n(l.callback)||l.callback()}}function I(e){let r={...E};if(n(e)||n(e.id))throw new Error("URLFormJS: `FormOptions` is not properly set, see README.");if(!(!n(e.FormJs_Sanitized)&&e.FormJs_Sanitized===!0))return r.id=e.id,n(e.prefix)||(r.prefix=e.prefix),n(e.shareURLArea)||(r.shareURLArea=e.shareURLArea),n(e.shareURL)||(r.shareURL=e.shareURL),n(e.shareURLBtn)||(r.shareURLBtn=e.shareURLBtn),n(e.queryLocation)||(r.queryLocation=e.queryLocation),n(e.preserveExtra)||(r.preserveExtra=e.preserveExtra),n(e.callback)||(r.callback=e.callback),n(e.cleanURL)||(r.cleanURL=e.cleanURL),r.FormJs_Sanitized=!0,r}function P(e){n(e)&&(e=g());let r=Object.keys(e.fragmentPairs);var t=new URL(window.location.origin);for(let s of m){let o=s.name,L=s.id,U=o;n(L)||(U=L);var a=document.getElementById(l.prefix+U);let c;a!==null&&(c=a.value,s.type==="bool"&&(a.checked?c="true":c=""));let R=n(c);!R&&l.queryLocation=="fragment"||r.includes(o)||s.queryLocation==="fragment"?e.fragmentPairs[o]=c:R?t.searchParams.delete(o):t.searchParams.set(o,c)}let f=S();if(!n(f.query)&&!l.cleanURL)for(let s in f.query)t.searchParams.set(s,f.query[s]);t.hash=x(e,f),n(e.fragmentPairs)&&(t.hash="");let i=document.querySelector(l.shareURL);console.debug(i,t),i!=null&&(i.innerHTML=t.href.link(t.href));let u=document.querySelector(l.shareURLArea);return u!=null&&(u.innerHTML=t.href),t}function S(){let e=g(),r={query:{},frag:{},queryKeys:[],fragKeys:[]},t=Object.keys(e.queryPairs),a=Object.keys(e.fragmentPairs),f=[];for(let i of m)f.push(i.name);for(let i of t)f.includes(i)||(r.query[i]=e[i],r.queryKeys.push(i));for(let i of a)f.includes(i)||(r.frag[i]=e.pairs[i],r.fragKeys.push(i));return r}function x(e,r){let t="#";if(n(e.fragmentParts))return t;n(e.fragmentParts.before)||(t+=e.fragmentParts.before),t+="?";var a=Object.keys(e.fragmentPairs).length-1,f=0,i="&";a===0&&(i="");for(let u in e.fragmentPairs)f===a&&(i=""),f++,!r.fragKeys.includes(u)&&(t+=u+"="+e.fragmentPairs[u]+i);if(!n(r.frag)&&!l.cleanURL){f=0,i="&",a=r.fragKeys.length-1;for(let u in r.frag)f===a&&(i=""),f++,t+=u+"="+r.frag[u]+i}return t+=e.fragmentParts.after,t}function F(){if(!d)throw new Error("URLFormJS: Init() must be called first to initialize the URLFormJS module.");var e=new FormData(h),r={};for(let[t,a]of e)(a=="true"||a=="on")&&(a=!0),(a=="false"||a=="unchecked")&&(a=!1),n(l)||n(l.prefix)||(t=t.substring(l.prefix.length)),n(a)||(r[t]=a);return r}function z(){return JSON.stringify(F())}function K(){if(!d)throw new Error("URLFormJS: Init() must be called first to initialize the URLFormJS module.");for(let e of m){let r=l.prefix+e.name,t=e.id;if(n(t)&&(t=r),e.type=="bool"){let f=document.getElementById(t);f!=null&&(f.checked=!1);continue}let a=document.getElementById(t);a!=null&&(a.value="")}}function j(){return n(F())}function n(e){return typeof e=="function"?!1:Array.isArray(e)?n(e[0]):e===Object(e)?Object.keys(e).length===0:!B(e)}function B(e){return!(e===!1||e==="false"||e===void 0||e==="undefined"||e===""||e===0||e==="0"||e===null||e==="null"||e==="NaN"||Number.isNaN(e)||e===Object(e))}"use strict";export{K as Clear,E as DefaultFormOptions,l as FormOptions,m as FormParameters,J as Init,j as IsEmpty,F as Objectify,A as PopulateFromURI,w as PopulateFromValues,z as Serialize};
